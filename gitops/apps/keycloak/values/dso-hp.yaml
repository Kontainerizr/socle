keycloak:
  auth:
    adminUser: <path:forge-dso/env/dso-hp/apps/keycloak/namespace/testcm-keycloak/values#admin>
    existingSecret: keycloak
    passwordSecretKey: admin-password
  production: true
  proxyHeaders: xforwarded
  extraEnvVars:
    - name: DSFR_THEME_HOME_URL
      value: https://{{ console_domain }}
    - name: DSFR_THEME_SERVICE_TITLE
      value: Cloud Pi Native
    - name: DSFR_THEME_BRAND_TOP
      value: "Ministere<br/>de l'interieur"
    - name: DSFR_THEME_CONTACT_EMAIL
      value: cloudpinative-relations@interieur.gouv.fr
  replicaCount: 3
  podSecurityContext:
    enabled: false
  containerSecurityContext:
    enabled: false
  resources:
    limits:
      memory: "2048Mi"
    requests:
      memory: "1024Mi"
  initContainers:
    - name: realm-ext-provider
      image: docker.io/curlimages/curl:8.11.1
      imagePullPolicy: IfNotPresent
      command:
        - sh
      args:
        - -c
        - curl -k -L -f -S -o /emptydir/app-providers-dir/keycloak-theme-dsfr.jar {{ dsc.keycloak.pluginDownloadUrl }}
      volumeMounts:
        - name: empty-dir
          mountPath: /emptydir
  ingress:
    enabled: true
    ingressClassName: openshift-default # secret Vault
    pathType: "Prefix"
    hostname: <path:forge-dso/env/dso-hp/apps/keycloak/namespace/testcm-keycloak/values#domain>
    path: /
    annotations:
      cert-manager.io/cluster-issuer: acme-issuer # secret Vault
      route.openshift.io/termination: "edge"
    labels:
      app: "keycloak"
    tls: true
    secrets: []
  networkPolicy:
    enabled: false
  serviceAccount:
    create: true
    name: ""
    automountServiceAccountToken: true
    annotations:
    extraLabels:
  pdb:
    create: false
  metrics:
    enabled: true
    serviceMonitor:
      enabled: true
      port: http
      endpoints:
        - path: '/metrics'
        - path: '/realms/master/metrics'
        - path: '/realms/dso/metrics'
  postgresql:
    enabled: false
  externalDatabase:
    host: keycloak-pg-cluster-rw
    port: 5432
    database: keycloak
    existingSecret: pg-cluster-keycloak-app
    existingSecretHostKey: host
    existingSecretPortKey: port
    existingSecretUserKey: username
    existingSecretPasswordKey: password
